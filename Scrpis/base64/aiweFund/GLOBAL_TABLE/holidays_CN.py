
import pandas as pd
from sdk.datasource import UpdateDataSource
rel_str = "[{'date': '2005-01-03'}, {'date': '2005-02-07'}, {'date': '2005-02-08'}, {'date': '2005-02-09'}, {'date': '2005-02-10'}, {'date': '2005-02-11'}, {'date': '2005-02-14'}, {'date': '2005-02-15'}, {'date': '2005-05-02'}, {'date': '2005-05-03'}, {'date': '2005-05-04'}, {'date': '2005-05-05'}, {'date': '2005-05-06'}, {'date': '2005-10-03'}, {'date': '2005-10-04'}, {'date': '2005-10-05'}, {'date': '2005-10-06'}, {'date': '2005-10-07'}, {'date': '2006-01-02'}, {'date': '2006-01-03'}, {'date': '2006-01-26'}, {'date': '2006-01-27'}, {'date': '2006-01-28'}, {'date': '2006-01-30'}, {'date': '2006-01-31'}, {'date': '2006-02-01'}, {'date': '2006-02-02'}, {'date': '2006-02-03'}, {'date': '2006-05-01'}, {'date': '2006-05-02'}, {'date': '2006-05-03'}, {'date': '2006-05-04'}, {'date': '2006-05-05'}, {'date': '2006-10-02'}, {'date': '2006-10-03'}, {'date': '2006-10-04'}, {'date': '2006-10-05'}, {'date': '2006-10-06'}, {'date': '2007-01-01'}, {'date': '2007-01-02'}, {'date': '2007-01-03'}, {'date': '2007-02-19'}, {'date': '2007-02-20'}, {'date': '2007-02-21'}, {'date': '2007-02-22'}, {'date': '2007-02-23'}, {'date': '2007-05-01'}, {'date': '2007-05-02'}, {'date': '2007-05-03'}, {'date': '2007-05-04'}, {'date': '2007-05-07'}, {'date': '2007-10-01'}, {'date': '2007-10-02'}, {'date': '2007-10-03'}, {'date': '2007-10-04'}, {'date': '2007-10-05'}, {'date': '2007-12-31'}, {'date': '2008-01-01'}, {'date': '2008-02-06'}, {'date': '2008-02-07'}, {'date': '2008-02-08'}, {'date': '2008-02-11'}, {'date': '2008-02-12'}, {'date': '2008-04-04'}, {'date': '2008-05-01'}, {'date': '2008-05-02'}, {'date': '2008-06-09'}, {'date': '2008-09-15'}, {'date': '2008-09-29'}, {'date': '2008-09-30'}, {'date': '2008-10-01'}, {'date': '2008-10-02'}, {'date': '2008-10-03'}, {'date': '2009-01-01'}, {'date': '2009-01-02'}, {'date': '2009-01-26'}, {'date': '2009-01-27'}, {'date': '2009-01-28'}, {'date': '2009-01-29'}, {'date': '2009-01-30'}, {'date': '2009-04-06'}, {'date': '2009-05-01'}, {'date': '2009-05-28'}, {'date': '2009-05-29'}, {'date': '2009-10-01'}, {'date': '2009-10-02'}, {'date': '2009-10-05'}, {'date': '2009-10-06'}, {'date': '2009-10-07'}, {'date': '2009-10-08'}, {'date': '2010-01-01'}, {'date': '2010-02-15'}, {'date': '2010-02-16'}, {'date': '2010-02-17'}, {'date': '2010-02-18'}, {'date': '2010-02-19'}, {'date': '2010-04-05'}, {'date': '2010-05-03'}, {'date': '2010-06-14'}, {'date': '2010-06-15'}, {'date': '2010-06-16'}, {'date': '2010-09-22'}, {'date': '2010-09-23'}, {'date': '2010-09-24'}, {'date': '2010-10-01'}, {'date': '2010-10-04'}, {'date': '2010-10-05'}, {'date': '2010-10-06'}, {'date': '2010-10-07'}, {'date': '2011-01-03'}, {'date': '2011-02-02'}, {'date': '2011-02-03'}, {'date': '2011-02-04'}, {'date': '2011-02-07'}, {'date': '2011-02-08'}, {'date': '2011-04-04'}, {'date': '2011-04-05'}, {'date': '2011-05-02'}, {'date': '2011-06-06'}, {'date': '2011-09-12'}, {'date': '2011-10-03'}, {'date': '2011-10-04'}, {'date': '2011-10-05'}, {'date': '2011-10-06'}, {'date': '2011-10-07'}, {'date': '2012-01-02'}, {'date': '2012-01-03'}, {'date': '2012-01-23'}, {'date': '2012-01-24'}, {'date': '2012-01-25'}, {'date': '2012-01-26'}, {'date': '2012-01-27'}, {'date': '2012-04-02'}, {'date': '2012-04-03'}, {'date': '2012-04-04'}, {'date': '2012-04-30'}, {'date': '2012-05-01'}, {'date': '2012-06-22'}, {'date': '2012-10-01'}, {'date': '2012-10-02'}, {'date': '2012-10-03'}, {'date': '2012-10-04'}, {'date': '2012-10-05'}, {'date': '2013-01-01'}, {'date': '2013-01-02'}, {'date': '2013-01-03'}, {'date': '2013-02-11'}, {'date': '2013-02-12'}, {'date': '2013-02-13'}, {'date': '2013-02-14'}, {'date': '2013-02-15'}, {'date': '2013-04-04'}, {'date': '2013-04-05'}, {'date': '2013-04-29'}, {'date': '2013-04-30'}, {'date': '2013-05-01'}, {'date': '2013-06-10'}, {'date': '2013-06-11'}, {'date': '2013-06-12'}, {'date': '2013-09-19'}, {'date': '2013-09-20'}, {'date': '2013-10-01'}, {'date': '2013-10-02'}, {'date': '2013-10-03'}, {'date': '2013-10-04'}, {'date': '2013-10-07'}, {'date': '2014-01-01'}, {'date': '2014-01-31'}, {'date': '2014-02-03'}, {'date': '2014-02-04'}, {'date': '2014-02-05'}, {'date': '2014-02-06'}, {'date': '2014-04-07'}, {'date': '2014-05-01'}, {'date': '2014-05-02'}, {'date': '2014-06-02'}, {'date': '2014-09-08'}, {'date': '2014-10-01'}, {'date': '2014-10-02'}, {'date': '2014-10-03'}, {'date': '2014-10-06'}, {'date': '2014-10-07'}, {'date': '2015-01-01'}, {'date': '2015-01-02'}, {'date': '2015-02-18'}, {'date': '2015-02-19'}, {'date': '2015-02-20'}, {'date': '2015-02-23'}, {'date': '2015-02-24'}, {'date': '2015-04-06'}, {'date': '2015-05-01'}, {'date': '2015-06-22'}, {'date': '2015-09-03'}, {'date': '2015-09-04'}, {'date': '2015-10-01'}, {'date': '2015-10-02'}, {'date': '2015-10-05'}, {'date': '2015-10-06'}, {'date': '2015-10-07'}, {'date': '2016-01-01'}, {'date': '2016-02-08'}, {'date': '2016-02-09'}, {'date': '2016-02-10'}, {'date': '2016-02-11'}, {'date': '2016-02-12'}, {'date': '2016-04-04'}, {'date': '2016-05-02'}, {'date': '2016-06-09'}, {'date': '2016-06-10'}, {'date': '2016-09-15'}, {'date': '2016-09-16'}, {'date': '2016-10-03'}, {'date': '2016-10-04'}, {'date': '2016-10-05'}, {'date': '2016-10-06'}, {'date': '2016-10-07'}, {'date': '2017-01-02'}, {'date': '2017-01-27'}, {'date': '2017-01-30'}, {'date': '2017-01-31'}, {'date': '2017-02-01'}, {'date': '2017-02-02'}, {'date': '2017-04-03'}, {'date': '2017-04-04'}, {'date': '2017-05-01'}, {'date': '2017-05-29'}, {'date': '2017-05-30'}, {'date': '2017-10-02'}, {'date': '2017-10-03'}, {'date': '2017-10-04'}, {'date': '2017-10-05'}, {'date': '2017-10-06'}, {'date': '2018-01-01'}, {'date': '2018-02-15'}, {'date': '2018-02-16'}, {'date': '2018-02-19'}, {'date': '2018-02-20'}, {'date': '2018-02-21'}, {'date': '2018-04-05'}, {'date': '2018-04-06'}, {'date': '2018-04-30'}, {'date': '2018-05-01'}, {'date': '2018-06-18'}, {'date': '2018-09-24'}, {'date': '2018-10-01'}, {'date': '2018-10-02'}, {'date': '2018-10-03'}, {'date': '2018-10-04'}, {'date': '2018-10-05'}, {'date': '2018-12-31'}, {'date': '2019-01-01'}, {'date': '2019-02-04'}, {'date': '2019-02-05'}, {'date': '2019-02-06'}, {'date': '2019-02-07'}, {'date': '2019-02-08'}, {'date': '2019-04-05'}, {'date': '2019-05-01'}, {'date': '2019-05-02'}, {'date': '2019-05-03'}, {'date': '2019-06-07'}, {'date': '2019-09-13'}, {'date': '2019-10-01'}, {'date': '2019-10-02'}, {'date': '2019-10-03'}, {'date': '2019-10-04'}, {'date': '2019-10-07'}, {'date': '2020-01-01'}, {'date': '2020-01-24'}, {'date': '2020-01-27'}, {'date': '2020-01-28'}, {'date': '2020-01-29'}, {'date': '2020-01-30'}, {'date': '2020-01-31'}, {'date': '2020-04-06'}, {'date': '2020-05-01'}, {'date': '2020-05-04'}, {'date': '2020-05-05'}, {'date': '2020-06-25'}, {'date': '2020-06-26'}, {'date': '2020-10-01'}, {'date': '2020-10-02'}, {'date': '2020-10-05'}, {'date': '2020-10-06'}, {'date': '2020-10-07'}, {'date': '2020-10-08'}, {'date': '2021-01-01'}, {'date': '2021-02-11'}, {'date': '2021-02-12'}, {'date': '2021-02-15'}, {'date': '2021-02-16'}, {'date': '2021-02-17'}, {'date': '2021-04-05'}, {'date': '2021-05-03'}, {'date': '2021-05-04'}, {'date': '2021-05-05'}, {'date': '2021-06-14'}, {'date': '2021-09-20'}, {'date': '2021-09-21'}, {'date': '2021-10-01'}, {'date': '2021-10-04'}, {'date': '2021-10-05'}, {'date': '2021-10-06'}, {'date': '2021-10-07'}, {'date': '2022-01-03'}, {'date': '2022-01-31'}, {'date': '2022-02-01'}, {'date': '2022-02-02'}, {'date': '2022-02-03'}, {'date': '2022-02-04'}, {'date': '2022-04-04'}, {'date': '2022-04-05'}, {'date': '2022-05-02'}, {'date': '2022-05-03'}, {'date': '2022-05-04'}, {'date': '2022-06-03'}, {'date': '2022-09-12'}, {'date': '2022-10-03'}, {'date': '2022-10-04'}, {'date': '2022-10-05'}, {'date': '2022-10-06'}, {'date': '2022-10-07'}]"

rel_lst = list(eval(rel_str[1:-1]))

df = pd.DataFrame(rel_lst)
df['date'] = pd.to_datetime(df.date)
schema = {
    'date_field': None,
    'category': '通用数据/日历',
    'partition_date': None,
    'desc': '假期日历',
    'friendly_name': '假期日历',
    'fields': {
        'date': {'desc': '日期', 'type': 'datetime64[ns]'}
    },
    'primary_key': ['date'],
    'active': False,
    'file_type': 'bdb'
}

UpdateDataSource().update(df=df, alias='holidays_CN', schema=schema, update_schema=True)
